<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Traducteur</title>
  <style>
    @font-face {
      font-family: 'Inter';
      src: local('Inter');
    }
    :root {
      --primary-blue: #4373d8;
      --text-dark: #090909;
      --text-gray: #4c5359;
      --text-light: #999;
      --border-light: rgba(118, 118, 128, 0.12);
      --background-light: #f5f5f5;
      --border-input: rgba(60, 60, 67, 0.29);
    }
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-color: #f0f0f0;
    }
    main {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    .translator-frame {
      border-radius: 30px;
      background-color: #fff;
      display: flex;
      margin: 0 auto;
      max-width: 480px;
      width: 100%;
      padding: 20px; /* Ajuster le padding général */
      flex-direction: column;
      overflow: hidden;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); /* Ajouter une légère ombre */
    }
    .translator-header {
      display: flex;
      margin-top: 20px; /* Réduire la marge du haut */
      width: 100%;
      max-width: 353px;
      align-items: stretch;
      gap: 16px; /* Réduire l'écart */
    }
    .header-content {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      font-family: 'Inter', sans-serif;
      color: var(--text-gray);
      font-weight: 400;
      letter-spacing: 0.2px;
      flex: 1;
    }
    .translator-title {
      color: var(--text-dark);
      font-family: 'SF Pro Display', sans-serif;
      font-size: 28px; /* Réduire la taille du titre */
      font-weight: 700;
      line-height: 1.2; /* Ajuster la hauteur de ligne */
      letter-spacing: -0.64px;
      margin: 0 0 5px; /* Ajouter une marge en bas du titre */
    }
    .powered-by {
      display: flex;
      align-items: center; /* Aligner verticalement */
      gap: 5px;
      font-size: 8px; /* Réduire la taille de la police */
      line-height: 1.6;
    }
    .powered-label {
      color: var(--text-gray);
    }
    .deepl-logo {
      width: 36px; /* Réduire la largeur du logo */
      aspect-ratio: 4.37;
      object-fit: contain;
    }
    .translator-description {
      color: var(--text-gray);
      text-align: center;
      font-size: 9px; /* Réduire la taille de la police */
      line-height: 1.4;
      align-self: flex-end;
      margin-top: 16px; /* Réduire la marge du haut */
      margin-bottom: 0;
    }
    .action-button {
      justify-content: center;
      align-items: center;
      border-radius: 20px;
      align-self: flex-start;
      display: flex;
      width: 36px; /* Réduire la taille du bouton */
      height: 36px; /* Réduire la taille du bouton */
      background-color: var(--text-dark);
      border: none;
      padding: 6px; /* Réduire le padding */
      cursor: pointer;
    }
    .action-icon {
      width: 20px; /* Réduire la taille de l'icône */
      aspect-ratio: 1.04;
      object-fit: contain;
    }
    .language-selector {
      border-radius: 20px;
      border: 1px solid var(--border-light);
      display: flex;
      margin-top: 10px; /* Réduire la marge du haut */
      width: 100%;
      max-width: 350px;
      padding: 8px; /* Réduire le padding */
      flex-direction: column;
      justify-content: center;
    }
    .language-controls {
      display: flex;
      width: 100%;
      align-items: center;
      gap: 20px; /* Réduire l'écart */
      justify-content: center;
    }
    .language-option {
      display: flex;
      padding: 8px; /* Réduire le padding */
      align-items: center;
      gap: 8px; /* Réduire l'écart */
      font-family: 'Inter', sans-serif;
      font-size: 10px; /* Réduire la taille de la police */
      color: var(--text-gray);
      font-weight: 400;
      white-space: nowrap;
      letter-spacing: 0.2px;
      line-height: 1.6;
    }
    .language-dot {
      background-color: #d9d9d9;
      border-radius: 50%;
      width: 14px; /* Réduire la taille du point */
      height: 14px; /* Réduire la taille du point */
    }
    .swap-button {
      align-items: center;
      border-radius: 40px;
      display: flex;
      padding: 8px; /* Réduire le padding */
      background-color: var(--primary-blue);
      border: none;
      width: 36px; /* Réduire la taille du bouton */
      height: 36px; /* Réduire la taille du bouton */
      cursor: pointer;
    }
    .swap-icon-container {
      display: flex;
      width: 100%;
      padding: 1px;
      overflow: hidden;
      align-items: center;
      justify-content: center;
    }
    .swap-icon {
      width: 18px; /* Réduire la taille de l'icône */
      aspect-ratio: 1.05;
      object-fit: contain;
      fill: #fff;
    }
    .translation-area {
      border-radius: 20px;
      margin-top: 10px; /* Réduire la marge du haut */
      width: 100%;
      max-width: 350px;
      background-color: var(--background-light);
    }
    .input-container {
      display: flex;
      justify-content: space-between;
      align-items: flex-start; /* Alignement au sommet pour le textarea multiligne */
      border-bottom: 1px solid var(--border-input);
      min-height: 60px; /* Ajuster la hauteur minimale pour le textarea */
      width: 100%;
      padding: 10px; /* Réduire le padding pour mieux s'adapter au textarea */
      box-sizing: border-box; /* Inclure le padding et la bordure dans la largeur et la hauteur */
    }
    .input-field {
      color: var(--text-dark); /* Couleur du texte saisi */
      font-family: 'Inter', sans-serif;
      font-size: 11px;
      font-weight: 400;
      line-height: 1.6;
      letter-spacing: 0.2px;
      margin: 0;
      border: none; /* Supprime la bordure par défaut */
      outline: none; /* Supprime l'outline au focus */
      resize: none; /* Empêche le redimensionnement manuel */
      height: 40px; /* Hauteur initiale approximative */
      width: 100%;
      padding: 0; /* Supprime le padding interne pour un alignement correct */
      box-sizing: border-box; /* Inclut le padding et la bordure dans la largeur et la hauteur */
    }
    .input-field::placeholder {
      color: var(--text-light); /* Style du texte de l'espace réservé */
    }
    .mic-button {
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
      margin-left: 10px; /* Ajouter un peu d'espace entre le textarea et le micro */
    }
    .mic-icon {
      width: 20px; /* Réduire la taille de l'icône */
      aspect-ratio: 1;
      object-fit: contain;
    }
    .translation-output {
      color: var(--text-light);
      min-height: 80px; /* Réduire la hauteur minimale */
      width: 100%;
      padding: 10px; /* Réduire le padding */
      font-family: 'Inter', sans-serif;
      font-size: 10px; /* Réduire la taille de la police */
      font-weight: 700;
      white-space: pre-wrap; /* Permet le retour à la ligne du texte traduit */
      letter-spacing: 0.2px;
      line-height: 1.6;
      box-sizing: border-box; /* Inclure le padding dans la largeur et la hauteur */
    }
  </style>
</head>
<body>
  <main class="translator-frame">
    <section class="translator-header">
      <div class="header-content">
        <h1 class="translator-title">Traducteur</h1>
        <div class="powered-by">
          <span class="powered-label">Powered by</span>
          <img src="https://cdn.builder.io/api/v1/image/assets/TEMP/4548f369398a6e22a68a96fd2421dc1ae6b8c141?placeholderIfAbsent=true&apiKey=38e47893336945848379668f2dc133bd" alt="DeepL" class="deepl-logo" />
        </div>
        <p class="translator-description">Traduisez dans plusieurs langues vos textes</p>
      </div>
      <button class="action-button">
        <img src="https://cdn.builder.io/api/v1/image/assets/TEMP/846a4464d4434a561e858d0e82c28e9554f91583?placeholderIfAbsent=true&apiKey=38e47893336945848379668f2dc133bd" alt="Action" class="action-icon" />
      </button>
    </section>

    <section class="language-selector">
      <div class="language-controls">
        <div class="language-option">
          <span class="language-dot"></span>
          <span class="language-name">Anglais</span>
        </div>
        <button class="swap-button">
          <div class="swap-icon-container">
            <img src="https://cdn.builder.io/api/v1/image/assets/TEMP/5087d6dd752bf76503dafb5092fcd4b4fb95bbfc?placeholderIfAbsent=true&apiKey=38e47893336945848379668f2dc133bd" alt="Swap languages" class="swap-icon" />
          </div>
        </button>
        <div class="language-option">
          <span class="language-dot"></span>
          <span class="language-name">Français</span>
        </div>
      </div>
    </section>

    <section class="translation-area">
      <div class="input-container">
        <textarea class="input-field" placeholder="Entrez le texte"></textarea>
        <button class="mic-button">
          <img src="https://cdn.builder.io/api/v1/image/assets/TEMP/d18eb7b5035f5e74f71fd750a5c67f213183cfa0?placeholderIfAbsent=true&apiKey=38e47893336945848379668f2dc133bd" alt="Microphone" class="mic-icon" />
        </button>
      </div>
      <div class="translation-output">Traduction</div>
    </section>
  </main>
  <script>
    const inputField = document.querySelector('.input-field');
    const translationOutput = document.querySelector('.translation-output');
    const micButton = document.querySelector('.mic-button');
    const swapButton = document.querySelector('.swap-button');
    const languageNames = document.querySelectorAll('.language-name');

    let sourceLang = 'en';
    let targetLang = 'fr';

    // Fonction de traduction via l'API LibreTranslate
    async function translate(text) {
      if (!text.trim()) {
        translationOutput.textContent = 'Traduction';
        return;
      }
      try {
        const response = await fetch('https://libretranslate.de/translate', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            q: text,
            source: sourceLang,
            target: targetLang,
            format: 'text'
          })
        });

        const data = await response.json();
        translationOutput.textContent = data.translatedText || 'Erreur de traduction';
      } catch (err) {
        translationOutput.textContent = 'Erreur réseau';
      }
    }

    // Écouteur d'événements pour la saisie dans le textarea
    inputField.addEventListener('input', (event) => {
      translate(event.target.value);
    });

    // Micro : reconnaissance vocale
    micButton.addEventListener('click', () => {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = sourceLang === 'en' ? 'en-US' : 'fr-FR';
      recognition.interimResults = false;
      recognition.maxAlternatives = 1;

      recognition.start();

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        inputField.value = transcript;
        translate(transcript);
      };

      recognition.onerror = () => {
        inputField.placeholder = 'Erreur vocale';
      };
    });

    // Échange des langues
    swapButton.addEventListener('click', () => {
      [sourceLang, targetLang] = [targetLang, sourceLang];

      // Inverser les étiquettes "Anglais" / "Français"
      const tempText = languageNames[0].textContent;
      languageNames[0].textContent = languageNames[1].textContent;
      languageNames[1].textContent = tempText;

      // Re-traduire si du texte est présent
      const currentText = inputField.value.trim();
      if (currentText) {
        translate(currentText);
      } else {
        translationOutput.textContent = 'Traduction'; // Réinitialiser la sortie si le champ est vide
      }
    });
  </script>
</body>
</html>
